((3) 0 () 6 ("Go down coridoor" "second" "left-coridoor" "third" "look-shelf-room" "second-scene-coridoor-key") () (c (c (? . 3) q ("Discovery" "Having found the key and opened the door, you see that it doesn't lead to a room at all, but rather a balcony overlooking a rolling green hills as far as the eye can see." (("ABC" #f (lambda (p) #t) (lambda (p) p)) ("Kill yourself. There is nothing more to do in life. This is the most beauty a human must see. As someone once said, 'See Naples and die!'" #f (lambda (p) #t) (lambda (p) p))) (lambda (p) p))) c (c (? . 2) c (c "Left coridoor" c "You see a large room filled with shelves. This must be the shelf storage room." c (c (c "Have a look around" c (? . 4) q (lambda (p) #t) (lambda (p) p))) q (lambda (p) p))) c (c "first" c (c "First scene" c "Welcome to the game" c (c (c (? . 0) c (? . 1) q (lambda (p) (> (player-hp p) 50)) (lambda (p) p)) c (c (? . 0) c (? . 1) q (lambda (p) (> (player-hp p) 50)) (lambda (p) p))) q (lambda (p) p))) c (c (? . 1) c (c "Second scene" c "Welcome to the the lower end of the coridoor. There is a small door." c (c (c "Turn left" c (? . 2) q (lambda (p) #t) (lambda (p) p)) c (c "Use a key to open the door" c (? . 3) c (c lambda c (q p) c (c if c (c member c (? . 5) q (player-backpack-items p)) q #t #f)) q (lambda (p) p))) q (lambda (p) p))) c (c (? . 4) c (c "Looking around in the shelf room" c "After a few minutes of looking on shelves high or low, you find a small iron key, the sort that unlocks old doors with poor security." c (c (c "Pick up the key, turn right and go up the coridoor." c (? . 1) c (q lambda (p) p) c (c lambda c (q p) c (c add-to-backpack c p c (? . 5))))) q (lambda (p) p)))))